# Location "/etc/bird/bird.conf"
# =====================================
# BIRD 2 - Route Server (IXP)
# Local AS: 64520
# Router-ID: 10.0.0.100
# =====================================

router id 10.0.0.100;

# ---- Device and Kernel ----
protocol device {
}

protocol kernel {
    persist;
    learn;
    ipv4 {
        import none;
        export none;
    };
}

protocol direct {
    ipv4 {
        import all;
    };
    interface "eth0";
}

# ---- Prefix Filter ----
filter RS_IMPORT_ALL {
    if net ~ [ 0.0.0.0/0{8,32} ] then accept;
    reject;
}

filter RS_EXPORT_ALL {
    if net ~ [ 0.0.0.0/0{8,32} ] then accept;
    reject;
}

# ---- Peer Group Template ----
template bgp RS_PEERS {
    local as 64520;
    graceful restart on;
    rs client;
    ipv4 {
#       next hop keep;
        import filter RS_IMPORT_ALL;
        export filter RS_EXPORT_ALL;
    };
}

# ---- Members ----
protocol bgp Member_1 from RS_PEERS {
    neighbor 10.0.0.1 as 64521;
    description "Member-1";
}

protocol bgp Member_2 from RS_PEERS {
    neighbor 10.0.0.2 as 64522;
    description "Member-2";
}

protocol bgp Member_3 from RS_PEERS {
    neighbor 10.0.0.3 as 64523;
    description "Member-3";
}

protocol bgp Member_4 from RS_PEERS {
    neighbor 10.0.0.4 as 64524;
    description "Member-4";
}

protocol bgp Cloudflare from RS_PEERS {
    neighbor 10.0.0.111 as 13335;
    description "Cloudflare";
}